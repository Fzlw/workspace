import{u as k,d as E}from"./index-82a350d0.js";import{X as f,Z as T,N as j}from"./el-message-box-0cba906a.js";import{P as F,g as I,r as O,u as d}from"./vue.esm-bundler-ca95eab4.js";import{c as x}from"./cloneDeep-fd8ee826.js";const U=i=>{const m=T(),{tableState:o,setState:c,...g}=k({mapColumn(t){const{formatter:e,editable:r,...n}=t;return{...n,formatter(s,w,u,S){return(f(r)||r===!0)&&s._editing?m(s,t)??"":e?e(s,w,u,S):E(u,n.rFormat,n.defaultValue)??u??n.defaultValue}}},...i,async query(t){if(!i.query)return{list:[]};const e=await i.query(t);return e.list=e.list.map(r=>{const n=x(r);return Object.assign(r,{_origin:F(n)})}),e}}),_=(t,e)=>{o.columns=o.columns.map(r=>r.prop===t?Object.assign(r,e):r)},p=t=>{t._editing=!0},b=t=>{if(a(t))return l(t);for(const e in t._origin)t[e]=t._origin[e];t._editing=!1},l=t=>{t._delete=!0},h=t=>{t._editing=!1},y=t=>{const e={_editing:!0,...t??null,_origin:void 0};return c({data:o.data.concat(e)}),e},R=t=>!!t._editing,a=t=>f(t._origin),C=()=>{const t=[],e=[],r=[];for(const n of o.data)if(n._delete)a(n)||r.push(d(n));else if(a(n))t.push(d(n));else for(const s in n._origin)if(!j(n[s],n._origin[s])){e.push(d(n));break}return[r,t,e]},q=I(()=>o.data.filter(t=>!t._delete)),v=O({...o,data:q});return{...g,tableState:v,setColumn:_,editRow:p,delRow:l,cancelRow:b,saveRow:h,addRow:y,rowIsEditing:R,getChangedRows:C,rowIsAdded:a,setState:c}};export{U as u};
//# sourceMappingURL=index-8daeb9f7.js.map
