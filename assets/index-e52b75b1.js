import{P as p,r as y,u as f,t as b}from"./vue.esm-bundler-2b92b106.js";import{c as d}from"./cloneDeep-1581ee03.js";import{Z as h}from"./el-message-box-8a9f8ff9.js";const g=i=>{const{prop:l,formItemProps:m,labelWidth:e,rules:c,requiredMsg:a,...C}=i;return{...C,prop:l,formItemProps:{prop:l,labelWidth:e,rules:c||(a?[{required:!0,message:a}]:void 0),...m}}};function j(i){const l=p(null),m=p(i.columns.map(o=>g(o))),e=y({submitting:!1,model:{...i.initData??null},columns:f(m).filter(o=>!o.hidden),ref(o){l.value=o==null?void 0:o.elForm}});return{formState:e,getColumn:o=>{for(const t of f(m))if(t.prop===o)return t;return null},setColumn:(o,t,n)=>{for(const u of e.columns)if(u.prop===o){for(const r of i.columns)if(r.prop===o){const s=d(r),w=g(Object.assign(s,t));Object.assign(u,w);break}break}h(n)||(e.model[o]=n)},toggleColumn:(o,t)=>{if(!o)return;const n=typeof o=="string"?{[o]:t}:Array.isArray(o)?o.reduce((r,s)=>(s&&(r[s]=t),r),{}):o,u=[];for(const r of f(m)){const s=r.prop;s&&s in n&&(r.hidden=h(n[s])?!r.hidden:!n[s]),!r.hidden&&u.push(r)}e.columns=u},submit:async o=>{var t;try{e.submitting=!0,(await((t=l.value)==null?void 0:t.validate())??!0)&&o&&await o(d(b(e.model))),e.submitting=!1}catch(n){throw e.submitting=!1,n}},setModel:(o,t=!1)=>{var n;if(t){e.model=d(b(o)),e.columns=f(m).filter(u=>!u.hidden),(n=l.value)==null||n.resetFields();return}e.model={...e.model,...o}},form:l,getModel:o=>e.model[o],patchColumn:(o,t)=>{if(t){const n=g({...t,prop:o.prop,formItemProps:o.formItemProps});Object.assign(o,n)}},originColumns:m}}export{g as f,j as u};
//# sourceMappingURL=index-e52b75b1.js.map
