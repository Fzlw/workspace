import{u as q,d as E}from"./index-1afa3475.js";import{X as f,Z as T,N as j}from"./el-message-box-22c42fed.js";import{P as F,g as I,r as O,u}from"./vue.esm-bundler-ca95eab4.js";import{c as x}from"./cloneDeep-f29889c5.js";const U=d=>{const m=T(),{tableState:o,setState:c,...g}=q({mapColumn(t){const{formatter:e,editable:r,...n}=t;return{...n,formatter(s,S,i,k){return(f(r)||r===!0)&&s._editing?m(s,t)??"":e?e(s,S,i,k):E(i,n.rFormat,n.defaultValue)??i??n.defaultValue}}},...d,async query(t){const e=await d.query(t);return e.list=e.list.map(r=>{const n=x(r);return Object.assign(r,{_origin:F(n)})}),e}}),_=(t,e)=>{o.columns=o.columns.map(r=>r.prop===t?Object.assign(r,e):r)},p=t=>{t._editing=!0},b=t=>{if(a(t))return l(t);for(const e in t._origin)t[e]=t._origin[e];t._editing=!1},l=t=>{t._delete=!0},h=t=>{t._editing=!1},R=t=>{const e={_editing:!0,...t??null,_origin:void 0};return c({data:o.data.concat(e)}),e},y=t=>!!t._editing,a=t=>f(t._origin),C=()=>{const t=[],e=[],r=[];for(const n of o.data)if(n._delete)a(n)||r.push(u(n));else if(a(n))t.push(u(n));else for(const s in n._origin)if(!j(n[s],n._origin[s])){e.push(u(n));break}return[r,t,e]},v=I(()=>o.data.filter(t=>!t._delete)),w=O({...o,data:v});return{...g,tableState:w,setColumn:_,editRow:p,delRow:l,cancelRow:b,saveRow:h,addRow:R,rowIsEditing:y,getChangedRows:C,rowIsAdded:a,setState:c}};export{U as u};
//# sourceMappingURL=index-1ccaf461.js.map
