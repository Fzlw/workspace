import{d as c,g as y,t as w,u as p}from"./vue.esm-bundler-ca95eab4.js";import{c as M}from"./cloneDeep-f29889c5.js";import{X as A,a0 as _}from"./el-message-box-22c42fed.js";const d=u=>{const{prop:n,formItemProps:r,label:s,labelWidth:a,rules:i,requiredMsg:m,hidden:v,...g}=u;return{...g,_hidden:v,prop:n,formItemProps:{prop:n,label:s,labelWidth:a,rules:i||(m?[{required:!0,message:m}]:[]),...r}}};function P(u){const n=c({...u.initData??null}),r=c(u.columns.map(e=>d(e))),s=c(null),a=c(!1),i=y(()=>{const e=r.value.filter(o=>!o._hidden);return{submitting:a.value,model:n.value,columns:e,ref(o){s.value=o==null?void 0:o.elForm}}}),m=e=>{for(const o of r.value)if(o.prop===e)return o;return null};return{formState:i,getColumn:m,setColumn:(e,o,l)=>{const t=u.columns.find(f=>f.prop===e),C=m(e);if(t&&C&&o){const f=M(t),b=d(Object.assign(f,o));Object.assign(C,b)}A(l)||(i.value.model[e]=l)},toggleColumn:(e,o)=>{if(_(e)&&!Array.isArray(e)){for(const t of r.value)t.prop in e&&(t._hidden=e[t.prop]);return}const l=Array.isArray(e)?e:[e];for(const t of r.value)l.includes(t.prop)&&(t._hidden=!o)},submit:async e=>{var o;try{a.value=!0,(await((o=s.value)==null?void 0:o.validate())??!0)&&e&&await e(w(p(n))),a.value=!1}catch(l){throw a.value=!1,l}},setModel:(e,o=!1)=>{var l;if(o){n.value=e,r.value=u.columns.map(t=>d(t)),(l=s.value)==null||l.clearValidate();return}n.value={...n.value,...e}},form:s,getModel:e=>n.value[e]}}export{d as f,P as u};
//# sourceMappingURL=index-729ede2f.js.map
