import{u as S,d as T}from"./index-aad5bf47.js";import{X as a,Z as j}from"./el-message-box-e5e35739.js";import{P as q,g as E,r as F,u}from"./vue.esm-bundler-ca95eab4.js";import{c as I}from"./cloneDeep-a9e32adb.js";const P=d=>{const c=j(),{tableState:o,...l}=S({mapColumn(e){const{formatter:t,editable:r,...n}=e;return{...n,formatter(s,v,i,k){return(a(r)||r===!0)&&s._editing?c(s,e)??"":t?t(s,v,i,k):T(i,n.rFormat,n.defaultValue)??i??n.defaultValue}}},...d,async query(e){const t=await d.query(e);return t.list=t.list.map(r=>{const n=I(r);return Object.assign(r,{_origin:q(n)})}),t}}),f=(e,t)=>{o.columns=o.columns.map(r=>r.prop===e?Object.assign(r,t):r)},m=e=>{e._editing=!0},g=e=>{for(const t in e._origin)e[t]=e._origin[t];e._editing=!1},_=e=>{e._delete=!0},p=e=>{e._editing=!1},b=e=>{const t={_editing:!0,...e??null,_origin:void 0};return o.data.push(t),t},h=e=>!!e._editing,R=e=>a(e._origin),w=()=>{const e=[],t=[],r=[];for(const n of o.data)if(n._delete)r.push(u(n));else if(a(n._origin))e.push(u(n));else for(const s in n._origin)if(n._origin[s]!==n[s]){t.push(u(n));break}return[r,e,t]},y=E(()=>o.data.filter(e=>!e._delete)),C=F({...o,data:y});return{...l,tableState:C,setColumn:f,editRow:m,delRow:_,cancelRow:g,saveRow:p,addRow:b,rowIsEditing:h,getChangedRows:w,rowIsAdded:R}};export{P as u};
//# sourceMappingURL=index-34fe4ffa.js.map
