import{u as S,d as T}from"./index-83833a79.js";import{X as _,Y as v,N as E}from"./el-message-box-dfb8e93c.js";import{Q as I,g as j,u as c}from"./vue.esm-bundler-2b92b106.js";import{c as F}from"./cloneDeep-da0589d6.js";const N=u=>{const{tableState:o,setState:l,...p}=S({mapColumn(t){const{formatter:e,editable:r,...n}=t;return{...n,formatter(a,s,i,f){return(_(r)||r===!0)&&a._editing?v(a,t)??"":e?e(a,s,i,f):T(i,n.rFormat,n.defaultValue)??i??n.defaultValue}}},...u,async query(t){if(!u.query)return{list:[]};const e=await u.query(t);return e.list=e.list.map(r=>{const n=F(r);return Object.assign(r,{_origin:I(n)})}),e}}),b=(t,e)=>{o.columns=o.columns.map(r=>r.prop===t?Object.assign(r,e):r)},h=t=>{t._editing=!0},R=t=>{if(d(t))return m(t);for(const e in t._origin)t[e]=t._origin[e];t._editing=!1},m=t=>{t._delete=!0},y=t=>{t._editing=!1},w=t=>{const e={_editing:!0,...t??null,_origin:void 0};return l({data:o.data.concat(e)}),e},k=(t,e,r=!0)=>{const n=c(o).data,a=n.length-1;if(!(!r&&(e<0||e>a))){for(let s=0;s<=a;s++)if(n[s]===t){const i=r?s+e:e,f=Math.max(Math.min(i,a),0),g=n.slice(0,s).concat(n.slice(s+1));g.splice(f,0,n[s]),l({data:g});break}}},q=t=>!!t._editing,d=t=>_(t._origin),x=()=>{const t=[],e=[],r=[];for(const n of o.data)if(n._delete)d(n)||r.push(c(n));else if(d(n))t.push(c(n));else for(const a in n._origin)if(!E(n[a],n._origin[a])){e.push(c(n));break}return[r,t,e]},C=j(()=>{const t=c(o);return{...t,data:t.data.filter(e=>!e._delete)}});return{...p,tableState:C,setColumn:b,editRow:h,delRow:m,cancelRow:R,saveRow:y,addRow:w,rowIsEditing:q,getChangedRows:x,rowIsAdded:d,setState:l,moveRow:k}};export{N as u};
//# sourceMappingURL=index-2a71ea51.js.map
