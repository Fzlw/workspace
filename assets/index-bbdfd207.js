import{P as b,r as k,u as a,o as M,t as I}from"./vue.esm-bundler-2b92b106.js";import{c as d}from"./cloneDeep-433dd14d.js";import{Z as v}from"./el-message-box-7697f0cd.js";const g=u=>{const{prop:l,formItemProps:m,labelWidth:t,rules:f,requiredMsg:c,...p}=u;return{...p,prop:l,formItemProps:{prop:l,labelWidth:t,rules:f||(c?[{required:!0,message:c}]:void 0),...m}}};function R(u){const l=b(null),m=b(u.columns.map(o=>g(o))),t=k({submitting:!1,model:{},columns:a(m).filter(o=>!o.hidden),ref(o){l.value=o==null?void 0:o.elForm}}),f=o=>{for(const r of a(m))if(r.prop===o)return r;return null},c=(o,r,n)=>{for(const i of t.columns)if(i.prop===o){for(const e of u.columns)if(e.prop===o){const s=d(e),P=g(Object.assign(s,r));Object.assign(i,P);break}break}v(n)||(t.model[o]=n)},p=(o,r)=>{if(r){const n=g({...r,prop:o.prop,formItemProps:o.formItemProps});Object.assign(o,n)}},C=(o,r)=>{if(!o)return;const n=typeof o=="string"?{[o]:r}:Array.isArray(o)?o.reduce((e,s)=>(s&&(e[s]=r),e),{}):o,i=[];for(const e of a(m)){const s=e.prop;s&&s in n&&(e.hidden=v(n[s])?!e.hidden:!n[s]),!e.hidden&&i.push(e)}t.columns=i},w=async o=>{var r;try{t.submitting=!0,(await((r=l.value)==null?void 0:r.validate())??!0)&&o&&await o(d(I(t.model))),t.submitting=!1}catch(n){throw t.submitting=!1,n}},h=(o,r=!1)=>{if(r){const n=[],i=[];for(const e of a(m))e.prop&&n.push(e.prop),!e.hidden&&i.push(e);for(const e in t.model)t.model[e]=void 0;t.columns=i,setTimeout(()=>{var e;return(e=l.value)==null?void 0:e.clearValidate(n)},0)}for(const n in o)t.model[n]=d(o[n])},y=o=>t.model[o];return M(()=>{u.initData&&h(d(u.initData))}),{formState:t,getColumn:f,setColumn:c,toggleColumn:C,submit:w,setModel:h,form:l,getModel:y,patchColumn:p,originColumns:m}}export{g as f,R as u};
//# sourceMappingURL=index-bbdfd207.js.map
