import{d as c,g as b,t as w,u as y}from"./vue.esm-bundler-b66df92b.js";import{c as M}from"./cloneDeep-e249f69f.js";import{W as _}from"./el-message-box-9d0a0f53.js";const d=s=>{const{prop:n,formItemProps:u,label:r,labelWidth:a,rules:i,requiredMsg:m,hidden:v,...g}=s;return{...g,_hidden:v,prop:n,formItemProps:{prop:n,label:r,labelWidth:a,rules:i||(m?[{required:!0,message:m}]:[]),...u}}};function O(s){const n=c({...s.initData??null}),u=c(s.columns.map(e=>d(e))),r=c(null),a=c(!1),i=b(()=>{const e=u.value.filter(o=>!o._hidden);return{submitting:a.value,model:n.value,columns:e,ref(o){r.value=o}}}),m=e=>{for(const o of u.value)if(o.prop===e)return o;return null};return{formState:i,getColumn:m,setColumn:(e,o,t)=>{const l=s.columns.find(f=>f.prop===e),C=m(e);if(l&&C&&o){const f=M(l),h=d(Object.assign(f,o));Object.assign(C,h)}_(t)||(i.value.model[e]=t)},toggleColumn:(e,o)=>{const t=Array.isArray(e)?e:[e];for(const l of u.value)t.includes(l.prop)&&(l._hidden=!o)},submit:async e=>{var o;try{a.value=!0,(await((o=r.value)==null?void 0:o.validate())??!0)&&e&&await e(w(y(n))),a.value=!1}catch(t){throw a.value=!1,t}},setModel:(e,o=!1)=>{var t;if(o){n.value=e,u.value=s.columns.map(l=>d(l)),(t=r.value)==null||t.clearValidate();return}n.value={...n.value,...e}},form:r,getModel:e=>n.value[e]}}export{d as f,O as u};
//# sourceMappingURL=index-154c9e7d.js.map
