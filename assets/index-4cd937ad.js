import{d as c,g as b,t as w,u as y}from"./vue.esm-bundler-ca95eab4.js";import{c as M}from"./cloneDeep-92892124.js";import{X as F}from"./el-message-box-ea0479af.js";const d=u=>{const{prop:t,formItemProps:r,label:s,labelWidth:a,rules:m,requiredMsg:i,hidden:v,...g}=u;return{...g,_hidden:v,prop:t,formItemProps:{prop:t,label:s,labelWidth:a,rules:m||(i?[{required:!0,message:i}]:[]),...r}}};function O(u){const t=c({...u.initData??null}),r=c(u.columns.map(e=>d(e))),s=c(null),a=c(!1),m=b(()=>{const e=r.value.filter(o=>!o._hidden);return{submitting:a.value,model:t.value,columns:e,ref(o){s.value=o==null?void 0:o.elForm}}}),i=e=>{for(const o of r.value)if(o.prop===e)return o;return null};return{formState:m,getColumn:i,setColumn:(e,o,l)=>{const n=u.columns.find(f=>f.prop===e),C=i(e);if(n&&C&&o){const f=M(n),h=d(Object.assign(f,o));Object.assign(C,h)}F(l)||(m.value.model[e]=l)},toggleColumn:(e,o)=>{const l=Array.isArray(e)?e:[e];for(const n of r.value)l.includes(n.prop)&&(n._hidden=!o)},submit:async e=>{var o;try{a.value=!0,(await((o=s.value)==null?void 0:o.validate())??!0)&&e&&await e(w(y(t))),a.value=!1}catch(l){throw a.value=!1,l}},setModel:(e,o=!1)=>{var l;if(o){t.value=e,r.value=u.columns.map(n=>d(n)),(l=s.value)==null||l.clearValidate();return}t.value={...t.value,...e}},form:s,getModel:e=>t.value[e]}}export{d as f,O as u};
//# sourceMappingURL=index-4cd937ad.js.map
