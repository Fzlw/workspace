import{u as q,d as E}from"./index-b7d89d3c.js";import{X as c,Z as S,N as T}from"./el-message-box-22c42fed.js";import{P as j,g as F,r as I,u}from"./vue.esm-bundler-ca95eab4.js";import{c as O}from"./cloneDeep-f29889c5.js";const P=d=>{const l=S(),{tableState:o,...f}=q({mapColumn(e){const{formatter:t,editable:r,...n}=e;return{...n,formatter(s,v,i,k){return(c(r)||r===!0)&&s._editing?l(s,e)??"":t?t(s,v,i,k):E(i,n.rFormat,n.defaultValue)??i??n.defaultValue}}},...d,async query(e){const t=await d.query(e);return t.list=t.list.map(r=>{const n=O(r);return Object.assign(r,{_origin:j(n)})}),t}}),m=(e,t)=>{o.columns=o.columns.map(r=>r.prop===e?Object.assign(r,t):r)},g=e=>{e._editing=!0},_=e=>{for(const t in e._origin)e[t]=e._origin[t];e._editing=!1},p=e=>{e._delete=!0},b=e=>{e._editing=!1},h=e=>{const t={_editing:!0,...e??null,_origin:void 0};return o.data.push(t),t},R=e=>!!e._editing,a=e=>c(e._origin),w=()=>{const e=[],t=[],r=[];for(const n of o.data)if(n._delete)a(n)||r.push(u(n));else if(a(n))e.push(u(n));else for(const s in n._origin)if(!T(n[s],n._origin[s])){t.push(u(n));break}return[r,e,t]},y=F(()=>o.data.filter(e=>!e._delete)),C=I({...o,data:y});return{...f,tableState:C,setColumn:m,editRow:g,delRow:p,cancelRow:_,saveRow:b,addRow:h,rowIsEditing:R,getChangedRows:w,rowIsAdded:a}};export{P as u};
//# sourceMappingURL=index-afbf744f.js.map
