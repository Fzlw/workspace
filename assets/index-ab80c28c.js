import{P as b,r as k,u as a,o as M,t as F}from"./vue.esm-bundler-2b92b106.js";import{c as d}from"./cloneDeep-8078fb08.js";import{Z as v}from"./el-message-box-76cb5148.js";const g=u=>{const{prop:l,formItemProps:m,labelWidth:n,rules:f,requiredMsg:c,...p}=u;return{...p,prop:l,formItemProps:{prop:l,labelWidth:n,rules:f||(c?[{required:!0,message:c}]:void 0),...m}}};function R(u){const l=b(null),m=b(u.columns.map(o=>g(o))),n=k({submitting:!1,model:{},columns:a(m).filter(o=>!o.hidden),ref(o){l.value=o==null?void 0:o.elForm}}),f=o=>{for(const t of a(m))if(t.prop===o)return t;return null},c=(o,t,r)=>{for(const i of n.columns)if(i.prop===o){for(const s of u.columns)if(s.prop===o){const e=d(s),P=g(Object.assign(e,t));Object.assign(i,P);break}break}v(r)||(n.model[o]=r)},p=(o,t)=>{if(t){const r=g({...t,prop:o.prop,formItemProps:o.formItemProps});Object.assign(o,r)}},C=(o,t)=>{if(!o)return;const r=typeof o=="string"?{[o]:t}:Array.isArray(o)?o.reduce((s,e)=>(e&&(s[e]=t),s),{}):o,i=[];for(const s of a(m)){const e=s.prop;e&&e in r&&(s.hidden=v(r[e])?!s.hidden:!r[e]),!s.hidden&&i.push(s)}n.columns=i},w=async o=>{var t;try{n.submitting=!0,(await((t=l.value)==null?void 0:t.validate())??!0)&&o&&await o(d(F(n.model))),n.submitting=!1}catch(r){throw n.submitting=!1,r}},h=(o,t=!1)=>{var r;if(t){const i=[],s=[];for(const e of a(m))e.prop&&i.push(e.prop),!e.hidden&&s.push(e);for(const e in n.model)n.model[e]=void 0;n.columns=s,(r=l.value)==null||r.resetFields(i)}for(const i in o)n.model[i]=d(o[i])},y=o=>n.model[o];return M(()=>{u.initData&&h(d(u.initData))}),{formState:n,getColumn:f,setColumn:c,toggleColumn:C,submit:w,setModel:h,form:l,getModel:y,patchColumn:p,originColumns:m}}export{g as f,R as u};
//# sourceMappingURL=index-ab80c28c.js.map
