import{u as k,d as S}from"./index-2fddcceb.js";import{c as T,u as j}from"./index-a872ae1c.js";import{N as q,v as E,r as F,u as a}from"./vue.esm-bundler-c47e0f3b.js";import{i as d}from"./el-loading-2c8f0dc1.js";const N=u=>{const c=j(),{tableState:o,...l}=k({mapColumn(e){const{formatter:t,editable:r,...n}=e;return{...n,formatter(s,w,i,C){return(d(r)||r===!0)&&s._editing?c(s,e)??"":t?t(s,w,i,C):S(i,n.rFormat,n.defaultValue)??i??n.defaultValue}}},...u,async query(e){const t=await u.query(e);return t.list=t.list.map(r=>{const n=T(r);return Object.assign(r,{_origin:q(n)})}),t}}),f=(e,t)=>{o.columns=o.columns.map(r=>r.prop===e?Object.assign(r,t):r)},m=e=>{e._editing=!0},g=e=>{for(const t in e._origin)e[t]=e._origin[t];e._editing=!1},_=e=>{e._delete=!0},p=e=>{e._editing=!1},b=e=>{const t={_editing:!0,...e??null,_origin:void 0};o.data.push(t)},h=e=>!!e._editing,R=()=>{const e=[],t=[],r=[];for(const n of o.data)if(n._delete)r.push(a(n));else if(d(n._origin))e.push(a(n));else for(const s in n._origin)if(n._origin[s]!==n[s]){t.push(a(n));break}return[r,e,t]},y=E(()=>o.data.filter(e=>!e._delete)),v=F({...o,data:y});return{...l,tableState:v,setColumn:f,editRow:m,delRow:_,cancelRow:g,saveRow:p,addRow:b,rowIsEditing:h,getChangedRows:R}};export{N as u};
//# sourceMappingURL=index-bda78a88.js.map
