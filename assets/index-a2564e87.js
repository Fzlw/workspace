import{d as v,x as p,r as w,t as y,u as M}from"./vue.esm-bundler-ca95eab4.js";import{c as F}from"./cloneDeep-fd8ee826.js";import{X as g}from"./el-message-box-0cba906a.js";const C=i=>{const{prop:l,formItemProps:m,label:e,labelWidth:c,rules:a,requiredMsg:f,...d}=i;return{...d,prop:l,formItemProps:{prop:l,label:e,labelWidth:c,rules:a||(f?[{required:!0,message:f}]:[]),...m}}};function x(i){const l=v(null),m=p(i.columns.map(o=>C(o))),e=w({submitting:!1,model:{...i.initData??null},columns:m.filter(o=>!o.hidden),ref(o){l.value=o==null?void 0:o.elForm}});return{formState:e,getColumn:o=>{for(const t of m)if(t.prop===o)return t;return null},setColumn:(o,t,n)=>{for(const u of e.columns)if(u.prop===o){for(const r of i.columns)if(r.prop===o){const s=F(r),h=C(Object.assign(s,t));Object.assign(u,h);break}break}g(n)||(e.model[o]=n)},toggleColumn:(o,t)=>{if(!o)return;const n=typeof o=="string"?{[o]:t}:Array.isArray(o)?o.reduce((r,s)=>(s&&(r[s]=t),r),{}):o,u=[];for(const r of m){const s=r.prop;s&&s in n&&(r.hidden=g(n[s])?!r.hidden:!n[s]),!r.hidden&&u.push(r)}e.columns=u},submit:async o=>{var t;try{e.submitting=!0,(await((t=l.value)==null?void 0:t.validate())??!0)&&o&&await o(y(M(e.model))),e.submitting=!1}catch(n){throw e.submitting=!1,n}},setModel:(o,t=!1)=>{var n;if(t){e.model=o,e.columns=m.filter(u=>!u.hidden),(n=l.value)==null||n.resetFields();return}e.model={...e.model,...o}},form:l,getModel:o=>e.model[o]}}export{C as f,x as u};
//# sourceMappingURL=index-a2564e87.js.map
