import{L as f,X as z,a1 as h}from"./el-message-box-0cba906a.js";import{d as D,x as p,r as M,w as T,u as v}from"./vue.esm-bundler-ca95eab4.js";var x=(t=>(t[t.dateTime=0]="dateTime",t[t.date=1]="date",t))(x||{});const C=t=>h(t).format("YYYY-MM-DD HH:mm:ss"),b=t=>h(t).format("YYYY-MM-DD"),w=(t,u,o)=>{if(u===0&&t)return C(t);if(u===1&&t)return b(t);if(t==="")return o},A=t=>{const u=D(null),o=p({currentPage:1,pageSize:20,total:0,pageSizes:[10,20,30,40,50],layout:"sizes, total, prev, pager, next, jumper","onUpdate:pageSize"(e){o.pageSize=e},"onUpdate:currentPage"(e){o.currentPage=e},...t.pagination}),l=p(t.columns.map(e=>{const{defaultValue:a="-",rFormat:s,formatter:d,...r}=e;return{...r,formatter:(i,Y,c,S)=>d?d(i,Y,c,S):w(c,s,a)??c??a,...t.mapColumn&&t.mapColumn(e)}})),n=M({loading:!1,pending:!1,data:[],selected:[],columns:l.filter(e=>!e.hidden),mode:t.mode??f.single,onNext(){n.mode===f.infinite&&m()},"onUpdate:selected"(e){n.selected=e},ref(e){u.value=e==null?void 0:e.elTable}}),g=async(e=!1)=>{if(!(!t.query||n.pending)){try{n.pending=!0,!e&&(n.loading=!0);const a=await t.query(v(o)),{list:s=[],total:d=0}=a??{},r=o.currentPage;n.data=r===1||n.mode===f.single?s:n.data.concat(s),o.total=d||s.length}catch(a){console.error(a)}n.pending=!1,n.loading=!1}},m=()=>{const{currentPage:e,pageSize:a,total:s=0}=o;!n.loading&&e*a<s&&(o.currentPage=e+1)},y=e=>{for(const a in e)a in n&&(n[a]=e[a])},P=(e,a)=>{if(!e)return;const s=typeof e=="string"?{[e]:a}:Array.isArray(e)?e.reduce((r,i)=>(i&&(r[i]=a),r),{}):e,d=[];for(const r of l){const i=r.prop;i&&i in s&&(r.hidden=z(s[i])?!r.hidden:!s[i]),!r.hidden&&d.push(r)}n.columns=d};return T(()=>[o.currentPage],()=>g()),{tableState:n,pagination:o,table:u,handleQuery:g,handleNext:m,setState:y,toggleColumn:P}};export{x as F,w as d,A as u};
//# sourceMappingURL=index-82a350d0.js.map
