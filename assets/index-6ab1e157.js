import{L as c,a1 as p}from"./el-message-box-ea0479af.js";import{d as h,r as l,w as z,u as D}from"./vue.esm-bundler-ca95eab4.js";var S=(e=>(e[e.dateTime=0]="dateTime",e[e.date=1]="date",e))(S||{});const T=e=>p(e).format("YYYY-MM-DD HH:mm:ss"),b=e=>p(e).format("YYYY-MM-DD"),M=(e,d,a)=>{if(d===0&&e)return T(e);if(d===1&&e)return b(e);if(e==="")return a},w=e=>{const d=h(null),a=l({currentPage:1,pageSize:20,total:0,pageSizes:[10,20,30,40,50],layout:"sizes, total, prev, pager, next, jumper","onUpdate:pageSize"(t){a.pageSize=t},"onUpdate:currentPage"(t){a.currentPage=t},...e.pagination}),r=l({loading:!1,data:[],selected:[],columns:e.columns.map(t=>{var m;const{defaultValue:n="-",rFormat:o,formatter:s,...i}=t;return((m=e.mapColumn)==null?void 0:m.call(e,t))??{...i,formatter:(Y,y,u,P)=>s?s(Y,y,u,P):M(u,o,n)??u??n}}),mode:e.mode??c.single,onNext(){r.mode===c.infinite&&g()},"onUpdate:selected"(t){r.selected=t},ref(t){d.value=t==null?void 0:t.elTable}}),f=async(t=!1)=>{if(!(!e.query||r.loading)){try{!t&&(r.loading=!0);const n=await e.query(D(a)),{list:o=[],total:s=0}=n??{},i=a.currentPage;r.data=i===1||r.mode===c.single?o:r.data.concat(o),a.total=s||o.length}catch(n){console.error(n)}r.loading=!1}},g=()=>{const{currentPage:t,pageSize:n,total:o=0}=a;!r.loading&&t*n<o&&(a.currentPage=t+1)};return z(()=>[a.currentPage],()=>f()),{tableState:r,pagination:a,table:d,handleQuery:f,handleNext:g}};export{S as F,M as d,w as u};
//# sourceMappingURL=index-6ab1e157.js.map
