import{u as q,d as C}from"./index-d7c31b80.js";import{Z as v,$ as A,P as I}from"./el-message-box-76cb5148.js";import{Q as M,g as F,u as d}from"./vue.esm-bundler-2b92b106.js";import{c as f}from"./cloneDeep-8078fb08.js";const $=g=>{const{tableState:i,setState:m,...p}=q({mapColumn(t){const{formatter:e,editable:r,...n}=t;return{...n,formatter(a,s,o,c){return(v(r)||r===!0)&&a._editing?A(a,t)??"":e?e(a,s,o,c):C(o,n.rFormat,n.defaultValue)??o??n.defaultValue}}},...g,async query(t){if(!g.query)return{list:[]};const e=await g.query(t);return e.list=e.list.map(r=>{const n=f(r);return Object.assign(r,{_origin:M(n)})}),e}}),b=(t,e)=>{i.columns=i.columns.map(r=>r.prop===t?Object.assign(r,e):r)},R=t=>{t._editing=!0},y=t=>{if(l(t))return _(t);for(const e in t._origin)t[e]=t._origin[e];t._editing=!1},_=t=>{t._delete=!0},w=t=>{t._editing=!1},S=(t,e=-1)=>{const r={_editing:!0,...t??null,_new:!0,_origin:t?f(t):void 0},n=[],a=i.data.length,s=e<0?a+1+e:e,o=s>=0?Math.min(a,s):0;for(let c=0,u=0;c<a;c++){const h=i.data[c];u===o&&n.push(r),!h._delete&&u++,n.push(h)}return o===a&&n.push(r),m({data:n}),r},T=(t,e,r=!0)=>{const n=d(i).data,a=n.length-1;if(!(!r&&(e<0||e>a))){for(let s=0;s<=a;s++)if(n[s]===t){const o=r?s+e:e,c=Math.max(Math.min(o,a),0),u=n.slice(0,s).concat(n.slice(s+1));u.splice(c,0,n[s]),m({data:u});break}}},x=t=>!!t._editing,l=t=>t._new===!0,E=()=>{const t=[],e=[],r=[];for(const n of i.data)if(n._delete)l(n)||r.push(d(n));else if(l(n))t.push(d(n));else for(const a in n._origin)if(!I(n[a],n._origin[a])){e.push(d(n));break}return[r,t,e]},k=F(()=>{const t=d(i);return{...t,data:t.data.filter(e=>!e._delete)}});return{...p,tableState:k,setColumn:b,editRow:R,delRow:_,cancelRow:y,saveRow:w,addRow:S,rowIsEditing:x,getChangedRows:E,rowIsAdded:l,setState:t=>{if(Array.isArray(t.data))for(const e of t.data)e._origin=e._origin??f(e);m(t)},moveRow:T,cloneRow:t=>f(t._origin)??{}}};export{$ as u};
//# sourceMappingURL=index-00d830d8.js.map
